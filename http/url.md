# url과 리소스

## url 이란

인터넷의 리소스를 가리키는 표준 이름이다.

## url 문법

```
<스킴>://<사용자이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>
```

| 컴포넌트  | 설명                                    | 기본값       |
| ----- | ------------------------------------- | --------- |
| 스킴    | 사용 포로토콜                               | 없음        |
| 사용자이름 | 몇몇 프로토콜은 리소스 접근을 위해 사용자 이름을 요구한다      | anonymous |
| 비밀번호  | 사용자의 이름에 콜론(:)으로 이어서 기술한다             | <이메일주소>   |
| 호스트   | 리소스를 호스팅하는 서버의 호스트명이나 IP 주소           | 없음        |
| 포트    | 호스팅하는 서버가 열어놓은 포트번호 (http의 기본 포트는 80) | 스킴에 따라 다름 |
| 경로    | 서버 내 리소스가 어디에 있는지를 가르킨다.              | 없음        |
| 파라미터  | 특정 스킴들에서 입력 파라미터를 기술하는 용도로 사용된다.      |           |

* 이름/값을 쌍으로 가진다
* 여러개를 가질 수 있다. | 없음 |\
  \| 질의 | 스킴에서 애플리케이션에 파라미터를 전달하는데 쓰인다. | 없음 |\
  \| 프래그먼트 | 리소스의 조각이나 일부분을 가리키는 이름이다.
* 서버에 전달되지 않는다. (http 서버는 객체의 일부가 아닌 전체만 다루기 때문) | 없음 |

> 파라미터와 질의의 차이점
>
> * 파라미터의 경우, 리소스에 대한 추가적인 정보(속성, 상태)를 제공할 때 사용
> * 질의의 경우, 서버에 요청할 데이터를 전달할 때 사용

## URL 인코딩

### url 인코딩은 us-ascii를 사용한다.

* 이유는 역사적으로 많은 컴퓨터 애플리케이션이 us-ascii 문서집합을 사용해 왔기 때문에 호환성과 안전성을 높이기 위해서이다.

> **us-ascii**\
> 7비트 인코딩으로, 총128개로 이루어져있다.

### 이스케이프 기능을이용하여 안전하지 않은 문자 사용을 가능하게 한다.

* 아스키 코드로는 표현되지 않는 언어가 수백개가 존재한다.
* 퍼센티지 기호(%)로 시작하여 ASCII 코드로 표현되는 두개의 16진수 숫자로 이뤄진 이스케이프 문자로 바꿔준다.
  * 한글의 경우, UTF-8로 인코딩 하여 각 바이트 값 앞에 %를 붙여준다.

## In my case…

### ‘/id(한글)’와 같이 url을 구성하였고, 새로고침을 하였을 때 문제가 발생한 경우가 있다.

* 이유: 브라우저의 경우, 새로고침을 할 경우 인코딩이 자동으로 적용이 되기 때문에 id 값이 퍼센트 인코딩이 적용된 값이 들어가 에러가 발생하게 된다.

### 해결책

* 인코딩 된 값이 들어올 경우, 디코딩 하여 값을 처리한 후 응답 메시지에 id 값을 넘겨주어 프론트에서 url 변경해주기

```java
	@GetMapping("/search/{key}")
	public ResponseEntity<?> searchAttractionsWithQuery(@PathVariable("key") String key) throws UnsupportedEncodingException {
		String decodedValue = URLDecoder.decode(key, "UTF-8");
		System.out.println(decodedValue);
		// 로직 처리
	}
```

```jsx
// vue
const { data } = await attractionApi
  .get("/search", { params })
  .then((response) => {
    router.replace({ path: `/map/search/${newValue}` });
    return response;
  });
```
